(()=>{var e={};e.id=539,e.ids=[539],e.modules={5522:e=>{e.exports={container:"checkAndPay_container__krd_O"}},4913:e=>{e.exports={container:"itemList_container__JmKkA",btn:"itemList_btn__owmm3"}},9557:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>H,default:()=>q,getServerSideProps:()=>k,getStaticPaths:()=>A,getStaticProps:()=>w,reportWebVitals:()=>N,routeModule:()=>U,unstable_getServerProps:()=>z,unstable_getServerSideProps:()=>B,unstable_getStaticParams:()=>L,unstable_getStaticPaths:()=>I,unstable_getStaticProps:()=>O});var s={};r.r(s),r.d(s,{default:()=>M,getServerSideProps:()=>T});var a=r(3865),l=r(9455),i=r(671),n=r(5525),o=r(2352),c=r(8732),d=r(2015),u=r(8905),h=r(9611),x=r(1106),p=r.n(x),j=r(8071),m=r(1793),b=r(8058),g=r(4913),y=r.n(g);let S=({items:e,handleShowPay:t})=>{let r=(0,m.w)(),{removeItem:s}=(0,m._$)(),a=(0,b.Py)(),[l,i]=(0,d.useState)(e),[n,o]=(0,d.useState)(!1),h=()=>{let e={...r};delete e.totalItemsQty;let t=Object.values(e);console.log("the itemsParsed",t),i(t)},x=async e=>{try{o(!0),await u.A.deleteItemFromCart(a.id_user,e)&&s(e),h(),o(!1)}catch(e){console.error("error deleting item from list",e.message),o(!1)}};return e?.length===0||0===r.totalItemsQty?(0,c.jsx)("div",{className:y().container,children:(0,c.jsxs)(j.Segment,{textAlign:"center",padded:!0,children:[(0,c.jsx)(j.Header,{as:"h1",content:"You don't have items in cart yet"}),(0,c.jsx)(p(),{href:"/",children:(0,c.jsx)("a",{children:(0,c.jsx)(j.Button,{color:"blue",size:"big",children:"Go to buy something"})})})]})}):(0,c.jsx)("div",{className:y().container,children:(0,c.jsxs)(j.Segment,{padded:!0,children:[(0,c.jsx)(j.Header,{as:"h1",textAlign:"center",children:"Your cart"}),(0,c.jsx)(j.List,{divided:!0,verticalAlign:"middle",children:l.map((e,t)=>{let{cover:s,title:a,price:l,id_product:i}=e,o=r[i]?.quantity;return(0,c.jsxs)(j.List.Item,{children:[(0,c.jsx)(j.List.Content,{floated:"right",className:y().btn,children:(0,c.jsx)(j.Button,{onClick:()=>x(i),color:"red",loading:n,children:"Delete"})}),(0,c.jsx)(j.Image,{rounded:!0,size:"small",src:s}),(0,c.jsxs)(j.List.Content,{children:[(0,c.jsx)(j.List.Header,{children:a}),(0,c.jsxs)("span",{children:[o," x $",l," = ",parseInt(o)*parseInt(l)]})]})]},t)})}),(0,c.jsx)(j.Button,{onClick:t,color:"blue",size:"large",fluid:!0,children:"Check and pay"})]})})};var _=r(3560),C=r(5522),P=r.n(C);let f=({items:e,handleShowPay:t})=>{let[r,s]=(0,d.useState)(0),[a,l]=(0,d.useState)(!1),[i,n]=(0,d.useState)(!1),{voidCart:o}=(0,m._$)(),{username:u}=(0,b.Py)(),{updateMoney:h}=(0,b.Jd)();(0,d.useEffect)(()=>{s(e.reduce((e,t)=>e+Number(t.quantity)*Number(t.price),0))},[]);let x=async()=>{l(!0),await _.A.purchase(e),h(-r),o(),l(!1),n(!0)},p=()=>{t()};return(0,c.jsxs)("div",{className:P().container,children:[(0,c.jsxs)(j.Modal,{size:"small",open:i,onClose:p,children:[(0,c.jsxs)(j.Modal.Header,{children:["Great Purchase ",u,"!"]}),(0,c.jsx)(j.Modal.Content,{children:(0,c.jsx)(j.Header,{as:"h3",content:"You can see all your purchases in your profile"})}),(0,c.jsx)(j.Modal.Actions,{children:(0,c.jsx)(j.Button,{positive:!0,onClick:p,content:"Ok"})})]}),(0,c.jsx)(j.Button,{onClick:t,color:"yellow",size:"medium",children:"Return to cart"}),(0,c.jsxs)(j.Table,{celled:!0,striped:!0,children:[(0,c.jsx)(j.Table.Header,{children:(0,c.jsxs)(j.Table.Row,{children:[(0,c.jsx)(j.Table.HeaderCell,{children:"Name"}),(0,c.jsx)(j.Table.HeaderCell,{children:"Quantity"}),(0,c.jsx)(j.Table.HeaderCell,{children:"Price per unit"}),(0,c.jsx)(j.Table.HeaderCell,{children:"Subtotal"}),(0,c.jsx)(j.Table.HeaderCell,{children:"TOTAL"})]})}),(0,c.jsxs)(j.Table.Body,{children:[e.map(({title:e,price:t,quantity:r},s)=>(0,c.jsxs)(j.Table.Row,{children:[(0,c.jsx)(j.Table.Cell,{children:e}),(0,c.jsx)(j.Table.Cell,{children:r}),(0,c.jsx)(j.Table.Cell,{children:t}),(0,c.jsx)(j.Table.Cell,{children:r*t}),(0,c.jsx)(j.Table.Cell,{children:"-"})]},s)),(0,c.jsxs)(j.Table.Row,{children:[(0,c.jsx)(j.Table.Cell,{content:"-"}),(0,c.jsx)(j.Table.Cell,{content:"-"}),(0,c.jsx)(j.Table.Cell,{content:"-"}),(0,c.jsx)(j.Table.Cell,{content:"-"}),(0,c.jsx)(j.Table.Cell,{children:(0,c.jsx)(j.Header,{as:"h3",children:r})})]})]})]}),(0,c.jsxs)(j.Button,{fluid:!0,color:"blue",size:"huge",loading:a,onClick:x,children:["Pay $",r]})]})},v=({items:e})=>{let[t,r]=(0,d.useState)(!1);return t?(0,c.jsx)(f,{items:e,handleShowPay:()=>r(!1)}):(0,c.jsx)(S,{items:e,handleShowPay:()=>r(!0)})},T=async({params:{userId:e},query:{token:t}})=>({props:{items:await u.A.getUserCartItems(e,t)}}),M=({items:e})=>(0,c.jsx)(h.A,{children:(0,c.jsx)(v,{items:e})}),q=(0,i.M)(s,"default"),w=(0,i.M)(s,"getStaticProps"),A=(0,i.M)(s,"getStaticPaths"),k=(0,i.M)(s,"getServerSideProps"),H=(0,i.M)(s,"config"),N=(0,i.M)(s,"reportWebVitals"),O=(0,i.M)(s,"unstable_getStaticProps"),I=(0,i.M)(s,"unstable_getStaticPaths"),L=(0,i.M)(s,"unstable_getStaticParams"),z=(0,i.M)(s,"unstable_getServerProps"),B=(0,i.M)(s,"unstable_getServerSideProps"),U=new a.PagesRouteModule({definition:{kind:l.A.PAGES,page:"/cart/[userId]",pathname:"/cart/[userId]",bundlePath:"",filename:""},components:{App:o.default,Document:n.default},userland:s})},3560:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(2906);!function(){var e=Error("Cannot find module '../config'");throw e.code="MODULE_NOT_FOUND",e}();let a=Object(function(){var e=Error("Cannot find module '../config'");throw e.code="MODULE_NOT_FOUND",e}()).baseUrl,l={};l.purchase=async function(e){try{for(let t of e)await s.A.post(`${a}/purchases/buy`,{id_user_buyer:t.id_user,id_product:t.id_product,quantity:t.quantity},{token:!0})}catch({message:e}){console.error("[error while purchasing]",e)}},l.getAllUserPurchases=async function(e){try{return await s.A.get(`${a}/purchases/${e}`,{token:!0})}catch({message:e}){console.error("[error getting user purchases]",e)}};let i=l},2124:e=>{"use strict";e.exports=require("@tarekraafat/autocomplete.js/dist/js/autoComplete")},8938:e=>{"use strict";e.exports=require("axios")},361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6653:e=>{"use strict";e.exports=require("nprogress")},2015:e=>{"use strict";e.exports=require("react")},2326:e=>{"use strict";e.exports=require("react-dom")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},8071:e=>{"use strict";e.exports=require("semantic-ui-react")},7085:e=>{"use strict";e.exports=require("styled-jsx/style")},9021:e=>{"use strict";e.exports=require("fs")},3873:e=>{"use strict";e.exports=require("path")},7910:e=>{"use strict";e.exports=require("stream")},4075:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[585,928,883,990,113,611],()=>r(9557));module.exports=s})();